<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JWT í…ŒìŠ¤íŠ¸</title>
</head>
<body>
<h1>JWT í† í° í…ŒìŠ¤íŠ¸</h1>
<p id="status">ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘...</p>
<script>
    // 1. ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì—ì„œ token ì¶”ì¶œ
    const params = new URLSearchParams(window.location.search);
    const token = params.get("token");

    // 2. ìˆìœ¼ë©´ localStorageì— ì €ì¥
    if (token) {
        localStorage.setItem("jwt", token);
        document.getElementById("status").innerText = "âœ… í† í° ì €ì¥ ì™„ë£Œ!";
        console.log("í† í°:", token);

        // ğŸ‘‰ ì €ì¥ëœ í† í°ìœ¼ë¡œ API í…ŒìŠ¤íŠ¸ (ì˜ˆì‹œ URL ìˆ˜ì • ê°€ëŠ¥)
        fetch("http://localhost:8080/api/me/stamps", {
            method: "GET",
            headers: {
                "Authorization": "Bearer " + token
            }
        })
            .then(res => res.json())
            .then(data => {
                console.log("API ì‘ë‹µ", data);
                document.body.innerHTML += "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
            })
            .catch(err => {
                document.body.innerHTML += "<p style='color:red'>API ìš”ì²­ ì‹¤íŒ¨: " + err + "</p>";
            });

    } else {
        document.getElementById("status").innerText = "âŒ í† í° ì—†ìŒ. ë¡œê·¸ì¸ ì‹¤íŒ¨";
    }
</script>
</body>
</html>
